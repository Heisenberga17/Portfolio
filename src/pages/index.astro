---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/astro/Section.astro';
import HeroSection from '@components/react/HeroSection';
import TechStrip from '@components/react/TechStrip';
import ProjectCard from '@components/react/ProjectCard';
import StatsWidget from '@components/react/StatsWidget';
import { techStripItems } from '@data/skills';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter((p) => p.data.featured)
  .sort((a, b) => a.data.order - b.data.order)
  .slice(0, 3);
---

<BaseLayout
  title="Heisen's Den | Developer & Entrepreneur"
  description="Portfolio of Heisen's — developer and entrepreneur based in Panama City. Building digital products that matter."
>
  <!-- Hero — above the fold, loads immediately -->
  <HeroSection client:load />

  <!-- Tech marquee strip -->
  <div class="border-y border-border bg-bg-secondary/60 overflow-hidden">
    <TechStrip items={techStripItems} client:visible />
  </div>

  <!-- Featured Projects -->
  <Section id="projects">
    <div class="mb-14 max-w-2xl">
      <p class="text-accent-primary font-mono text-sm tracking-widest uppercase mb-3">Selected Work</p>
      <h2 class="text-4xl md:text-5xl font-display font-bold leading-tight">
        Featured <span class="text-accent-secondary">Projects</span>
      </h2>
      <p class="text-text-secondary mt-4 text-lg leading-relaxed">
        A curated selection of projects where design meets engineering.
      </p>
    </div>

    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {featuredProjects.map((project) => (
        <ProjectCard
          client:visible
          slug={project.id}
          title={project.data.title}
          description={project.data.description}
          image={project.data.image}
          tags={project.data.tags}
          category={project.data.category}
        />
      ))}
    </div>

    <div class="mt-12 text-center">
      <a
        href="/projects"
        class="group inline-flex items-center gap-2 rounded-lg border border-border bg-bg-card px-6 py-3 text-sm font-medium text-text-primary transition-all hover:border-accent-primary hover:shadow-[0_0_24px_rgba(45,87,65,0.15)]"
      >
        View All Projects
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </a>
    </div>
  </Section>

  <!-- About Preview -->
  <Section id="about" background="secondary">
    <div class="grid gap-12 lg:grid-cols-5 items-center">
      <!-- Text column — wider -->
      <div class="lg:col-span-3">
        <p class="text-accent-primary font-mono text-sm tracking-widest uppercase mb-3">Who I Am</p>
        <h2 class="text-4xl md:text-5xl font-display font-bold leading-tight mb-6">
          Building <span class="text-accent-secondary">Digital</span> Products
        </h2>
        <p class="text-text-secondary text-lg leading-relaxed mb-4">
          I'm a developer and entrepreneur based in Panama City. I craft
          performant web experiences and build products that solve real
          problems — from sports platforms to service businesses.
        </p>
        <p class="text-text-secondary leading-relaxed mb-8">
          My work sits at the intersection of clean code, thoughtful design,
          and practical business sense. Every project is an opportunity to
          push what's possible on the modern web.
        </p>
        <a
          href="/about"
          class="group inline-flex items-center gap-2 text-accent-primary font-medium transition-colors hover:text-accent-hover"
        >
          Read More About Me
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        </a>
      </div>

      <!-- Stats column -->
      <div class="lg:col-span-2">
        <StatsWidget client:visible />
      </div>
    </div>
  </Section>
</BaseLayout>
