---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/astro/Section.astro';
import HeroSection from '@components/react/HeroSection';
import TechStrip from '@components/react/TechStrip';
import ProjectCardSwap from '@components/react/ProjectCardSwap';
import StatusWidget from '@components/react/StatusWidget';
import { techStripItems } from '@data/skills';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter((p) => p.data.featured)
  .sort((a, b) => a.data.order - b.data.order)
  .slice(0, 3);

const featuredProjectsData = featuredProjects.map((p) => ({
  slug: p.id,
  title: p.data.title,
  description: p.data.description,
  image: p.data.image,
  tags: p.data.tags,
  category: p.data.category,
}));
---

<BaseLayout
  title="Heisen's Den | Developer"
  description="Portfolio of Heisen's — developer based in Panama City building web platforms and digital products."
>
  <!-- Hero — above the fold, loads immediately -->
  <HeroSection client:load />

  <!-- Tech marquee strip -->
  <div class="border-y border-border bg-bg-secondary/60 overflow-hidden">
    <TechStrip items={techStripItems} client:visible />
  </div>

  <!-- Featured Projects -->
  <Section id="projects">
    <div class="flex flex-col sm:flex-row sm:items-baseline justify-between gap-4 mb-14">
      <h2 class="text-3xl md:text-4xl font-bold leading-tight">Projects</h2>
      <a
        href="/projects"
        class="group inline-flex items-center gap-2 text-accent-primary font-medium text-sm transition-colors hover:text-accent-hover"
      >
        See all
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </a>
    </div>

    <ProjectCardSwap client:visible projects={featuredProjectsData} />
  </Section>

  <!-- About Preview -->
  <Section id="about" background="secondary">
    <div class="grid gap-12 lg:grid-cols-5 items-center">
      <!-- Text column — wider -->
      <div class="lg:col-span-3">
        <p class="text-text-secondary text-lg leading-relaxed mb-4">
          Developer out of Panama City. I built
          <strong class="text-text-primary">Massport</strong> (football tournament platform),
          <strong class="text-text-primary">MicroClean</strong> (cleaning service site), and
          <strong class="text-text-primary">Casa 24 Records</strong> (indie music collective site).
        </p>
        <p class="text-text-secondary leading-relaxed mb-8">
          I like making things that people actually use — if it works
          and it's fast, ship it.
        </p>
        <a
          href="/about"
          class="group inline-flex items-center gap-2 text-accent-primary font-medium transition-colors hover:text-accent-hover"
        >
          More about me
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform group-hover:translate-x-1"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        </a>
      </div>

      <!-- Status column -->
      <div class="lg:col-span-2">
        <StatusWidget client:visible />
      </div>
    </div>
  </Section>
</BaseLayout>
